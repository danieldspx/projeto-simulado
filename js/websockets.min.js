var conn=new WebSocket("ws://localhost:8080");conn.onopen=function(e){console.log("Connection established!")},conn.onmessage=function(e){var t=e.data;if("1"==t.charAt(0)){t=t.substring(1);var i=t.search("&&&"),o=t.substring(i+3),n=parseInt(t.substring(0,i)),a="db_notificacao.php";$.ajax({type:"POST",dataType:"html",url:a,data:{tipo:1,id_notf:n}});var l="";-1!=document.getElementById("addNotification").innerHTML.search("li")&&(l="<li role='separator' class='divider'></li>"),$("#addNotification").append(l+"<li class='notificacao' id='"+n+"'>"+o+"</li>");var s=document.getElementById("badge"),r=isNaN(parseInt(s.innerHTML))?1:parseInt(s.innerHTML)+1;r>99&&(r="99+"),s.innerHTML=r,$("#badge").removeClass("dnone"),"notifications"==$("#iconNotif").html()&&$("#iconNotif").html("notifications_active"),$("#iconNotif").addClass("shakeIt");var c=document.getElementById("iconNotif");$("body").append("<audio autoplay id='audioNotif'><source src='sounds/notificacao.mp3' type='audio/mp3'></audio>"),c.addEventListener("animationend",function(){$("#iconNotif").removeClass("shakeIt")},!1),setTimeout(function(){var e=document.getElementById("audioNotif");e.parentNode.removeChild(e)},1e3)}else if("2"==t.charAt(0)){t=t.substring(1);var d=t.split("-");document.getElementById("painelq"+d[1])&&$.ajax({type:"POST",dataType:"html",url:"busca_comentario.php",data:{id_comentario:d[0],id_questao:d[1]},success:function(e){var t=document.getElementById("comentariosGerais"+d[1]);-1==t.innerHTML.search("alert alert-danger")?t.innerHTML+=e:t.innerHTML=e}})}else if("3"==t.charAt(0)){t=t.substring(1);var d=t.split("-"),u=document.getElementById("painelComentario"+d[0]+d[1]);u&&u.parentNode.removeChild(u);var f=document.getElementById("comentariosGerais"+d[0]);""==f.innerHTML&&(f.innerHTML='<tr><div class="alert alert-danger" style=\'margin-top: 20px;\' role="alert"><strong>Nenhum comentário encontrado, atualize a página e tente novamente.</strong></div></tr>')}};